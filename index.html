<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Formulaire Multi-Étapes</title>
  <link rel="stylesheet" href="styles.css"/>

  <!-- EmailJS doit être chargé avant ton script -->
  <script defer src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3.11.0/dist/email.min.js"></script>
  <script defer src="script.js"></script>
</head>
<body>
  <header>
    <img src="Logo2.svg" alt="Logo de l'entreprise">
  </header>

  <main>
    <div class="form-container">
      <!-- Zone messages -->
      <div id="messageContainer" class="message" aria-live="polite"></div>

      <!-- Barre d’avancement -->
      <div class="wizard-steps" id="wizardSteps">
        <div class="wizard-line" id="wizardLine"></div>

        <div class="wizard-step" data-step="0">
          <div class="wizard-circle">1</div>
          <div class="wizard-label">Coordonnées</div>
        </div>

        <div class="wizard-step" data-step="1">
          <div class="wizard-circle">2</div>
          <div class="wizard-label">Adresse</div>
        </div>

        <div class="wizard-step" data-step="2">
          <div class="wizard-circle">3</div>
          <div class="wizard-label">Demande</div>
        </div>

        <div class="wizard-step" data-step="3">
          <div class="wizard-circle">4</div>
          <div class="wizard-label">Validation</div>
        </div>
      </div>

      <form id="repairForm" novalidate>
        <!-- Étape 1 -->
        <div class="form-step active">
          <h2>Identification du demandeur</h2>

          <label for="name">Nom complet *</label>
          <input type="text" id="name" name="name" placeholder="Jean Dupont" required>

          <label for="email">Email *</label>
          <input type="email" id="email" name="email" placeholder="exemple@mail.com" required>
          <span class="error-message" id="emailError"></span>

          <label for="phone">Téléphone *</label>
          <input type="tel" id="phone" name="phone" placeholder="06 12 34 56 78"
                 required pattern="^0[1-9]([-. ]?[0-9]{2}){4}$" minlength="10" maxlength="14">

          <div class="role-container">
            <label>Vous êtes ? *</label>
            <div class="button-group">
              <button type="button" class="select-btn" data-value="Propriétaire" aria-pressed="false">Propriétaire</button>
              <button type="button" class="select-btn" data-value="Locataire" aria-pressed="false">Locataire</button>
            </div>
            <input type="hidden" id="role" name="role" required>
            <div class="field-error" hidden>Veuillez sélectionner une option.</div>
          </div>
        </div>

        <!-- Étape 2 -->
        <div class="form-step">
          <h2>Adresse de l'intervention</h2>

          <label for="address">Adresse *</label>
          <input type="text" id="address" name="address" placeholder="10 rue des Lilas" required>

          <label for="addressComplement">Complément d'adresse</label>
          <input type="text" id="addressComplement" name="addressComplement" placeholder="Bâtiment, étage, etc.">

          <label for="postalCode">Code postal *</label>
          <input type="text" id="postalCode" name="postalCode" placeholder="75000" required pattern="^[0-9]{5}$">

          <label for="city">Ville *</label>
          <input type="text" id="city" name="city" placeholder="Paris" required>
        </div>

        <!-- Étape 3 -->
        <div class="form-step">
          <h2>Intervention</h2>

          <label>Type d'intervention *</label>
          <div class="button-group">
            <button type="button" class="select-btn" data-value="Électricité">
              <!-- Icône inline (pas de lien externe fragile) -->
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="30" height="30" aria-hidden="true">
                <path d="M21 10c-2.757 0-5 2.243-5 5v3c0 2.206-1.794 4-4 4s-4-1.794-4-4v-3c2.757 0 5-2.243 5-5V7h1V5h-3V0H9v5H5V0H3v5H0v2h1v3c0 2.757 2.243 5 5 5v3c0 3.309 2.691 6 6 6s6-2.691 6-6v-3c0-1.654 1.346-3 3-3h3v-2h-3ZM6 13c-1.654 0-3-1.346-3-3V7h8v3c0 1.654-1.346 3-3 3H6Z"/>
              </svg>
            </button>
            <button type="button" class="select-btn" data-value="Plomberie">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="30" height="30" aria-hidden="true">
                <path d="M21.768 19.732a2.501 2.501 0 1 1-3.536 0L20 18.003l1.768 1.729ZM24 14v2h-8v-2c0-.552-.449-1-1-1H0v-2h9V7H0V5h9V2H4V0h12v2h-5v3h4c4.962 0 9 4.037 9 9Zm-2 0c0-3.859-3.14-7-7-7h-4v4h4c1.654 0 3 1.346 3 3h4Z"/>
              </svg>
            </button>
            <button type="button" class="select-btn" data-value="Serrurerie">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="30" height="30" aria-hidden="true">
                <path d="M7.505 24A7.5 7.5 0 0 1 5.469 9.283a7.368 7.368 0 0 1 3.881-.048l7.908-7.906A4.5 4.5 0 0 1 20.464 0 3.539 3.539 0 0 1 24 3.536a4.508 4.508 0 0 1-1.328 3.207L22 7.415A2.014 2.014 0 0 1 20.586 8H19v1a2 2 0 0 1-2 2h-1v1.586A1.986 1.986 0 0 1 15.414 14l-.65.65a7.334 7.334 0 0 1-.047 3.88 7.529 7.529 0 0 1-6.428 5.429 7.654 7.654 0 0 1-.784.041Zm0-13a5.5 5.5 0 1 0 5.289 6.99 5.4 5.4 0 0 0-.1-3.3 1 1 0 0 1 .238-1.035L14 12.586V11a2 2 0 0 1 2-2h1V8a2 2 0 0 1 2-2h1.586l.672-.672A2.519 2.519 0 0 0 22 3.536 1.537 1.537 0 0 0 20.465 2a2.52 2.52 0 0 0-1.793.743l-8.331 8.33a1 1 0 0 1-1.036.237A5.462 5.462 0 0 0 7.5 11ZM5 18a1 1 0 1 0 1-1 1 1 0 0 0-1 1Z"/>
              </svg>
            </button>
            <button type="button" class="select-btn" data-value="Vitrerie">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="30" height="30" aria-hidden="true">
                <path d="M22 22V3c0-1.654-1.346-3-3-3H5C3.346 0 2 1.346 2 3v19H0v2h24v-2h-2Zm-2 0h-7v-9h7v9Zm0-19v8h-7V2h6c.551 0 1 .449 1 1ZM5 2h6v9H4V3c0-.551.449-1 1-1ZM4 13h7v9H4v-9Z"/>
              </svg>
            </button>
            <button type="button" class="select-btn" data-value="Autre">
              <span class="select-text">Autre</span>
            </button>
          </div>
          <input type="hidden" id="type" name="type" required>
          <div class="field-error" hidden>Veuillez sélectionner un type d’intervention.</div>

          <label for="description">Descriptif de l'intervention *</label>
          <textarea id="description" name="description" placeholder="Exemple : Problème avec le circuit électrique, court-circuit..." required></textarea>

          <div class="priority-container">
            <label>Intervention prioritaire ? *</label>
            <div class="button-group">
              <button type="button" class="select-btn" data-value="Oui">Oui</button>
              <button type="button" class="select-btn" data-value="Non">Non</button>
            </div>
            <input type="hidden" id="priority" name="priority" required>
            <div class="field-error" hidden>Veuillez choisir Oui ou Non.</div>
          </div>
        </div>

        <!-- Étape 4 -->
        <div class="form-step">
          <h2>Récapitulatif</h2>
          <div class="summary">
            <p><strong>Vous êtes :</strong> <span id="summaryRole"></span></p>
            <p><strong>Nom :</strong> <span id="summaryName"></span></p>
            <p><strong>Email :</strong> <span id="summaryEmail"></span></p>
            <p><strong>Téléphone :</strong> <span id="summaryPhone"></span></p>
            <p><strong>Adresse :</strong> <span id="summaryAddress"></span></p>
            <p><strong>Type d'intervention :</strong> <span id="summaryType"></span></p>
            <p><strong>Descriptif :</strong> <span id="summaryDescription"></span></p>
            <p><strong>Intervention prioritaire :</strong> <span id="summaryPriority"></span></p>
          </div>

          <div class="cgu-container">
            <input type="checkbox" id="acceptCgu" required>
            <label for="acceptCgu">
              J’accepte les
              <a href="conditions.html" target="_blank">Conditions Générales d’Utilisation</a>
            </label>
          </div>
        </div>

		
        <!-- Navigation -->
        <div class="form-navigation">
          <!-- Bouton précédent (flèche seule) -->
          <button type="button" id="prevBtn" class="nav-btn nav-prev" aria-label="Étape précédente">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="22" height="22" aria-hidden="true">
              <path fill="currentColor" d="M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
            </svg>
          </button>

          <!-- Bouton suivant (texte + flèche) -->
          <button type="button" id="nextBtn" class="nav-btn nav-next">
            <span>Suivant</span>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="22" height="22" aria-hidden="true">
              <path fill="currentColor" d="M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"/>
            </svg>
          </button>

          <!-- Bouton soumettre (remplace “Suivant” à la dernière étape) -->
          <button type="submit" id="submitBtn" class="nav-btn nav-submit">Soumettre la demande</button>
        </div>
      </form>
    </div>
  </main>

  <!-- Popup “hors zone” (facultatif, mais inclus pour fonctionner partout) -->
  <div id="popup-departement" class="popup-overlay" aria-hidden="true" style="display:none">
    <div class="popup-content" role="dialog" aria-modal="true" aria-labelledby="popupTitle">
      <h3 id="popupTitle">Service non disponible</h3>
      <p>Désolé, le service n’est pas encore accessible dans votre département.<br>
         Laissez votre email pour être prévenu de notre arrivée :</p>
      <input type="email" id="waitlistEmail" placeholder="votre@email">
      <div class="popup-actions">
        <button type="button" id="popupSendBtn">Me prévenir</button>
        <button type="button" id="popupCloseBtn">Fermer</button>
      </div>
      <p class="popup-hint">Nous n’utilisons votre email que pour vous notifier de l’ouverture.</p>
    </div>
  </div>
</body>
</html>